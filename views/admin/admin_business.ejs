<!doctype html>
<html lang="en">
<head>
	<% include templates/admin_head.ejs %>
</head>
<body id="top">

<!-- Preloader -->
<!-- <div id="preloader">
	<div id="status">
		<div class="loader"></div>
	</div>
</div> -->
<!-- /Preloader -->

<div id="body-wrapper" class="body-container">

	<!-- Header begins -->
	<header class="main-nav clearfix">
		<% include templates/admin_header.ejs %>
	</header>
	<!-- /Header ends -->

	<!-- 네비게이션!@!@-->
	<aside class="menu">
		<div class="left-aside-container">			
			<% include templates/admin_sidebar.ejs %>
			<!-- /User profile -->
			<!-- Main menu -->
			<div class="menu-container">
				
			</div>
			<!-- /Main menu -->
		</div>
	</aside>
	<!-- /Sidebar -->

	<!-- Page container begins -->
	<section class="main-container">
		<h1 style="display:none">Empty Heading</h1>

			<!--Page Header-->
			<div class="header">
				<div class="header-content">
					<div class="page-title">
						<i class="icon-table2 position-left"></i> Advanced datatable
					</div>
				</div>
			</div>
			<!--/Page Header-->

			<div class="container-fluid page-content">

				<!-- Individual column searching (text fields) -->
				<div class="card card-inverse card-flat table-responsive">
					<div class="card-header">
						<div class="card-title">Individual column searching <span class="text-semibold">(Text fields)</span></div>
					</div>
					<div class="card-block p-b-0">
						<p>Individual columns searching with <code>text inputs</code>. It can be used by adding <code>column().search()</code> method to the datatable.</p>
					</div>
					<div class="table-responsive">
						<button type="button" id="addRow"></button>
					<table class="table datatable-button-init-basic" id="tList">
						<thead>
							<tr>
                                <th>B_ID</th>
                                <th>B_Name</th>
                                <th>B_Tel</th>
                                <th>B_Fax</th>
                                <th>B_Email</th>
                                <th>B_Zip</th>
                                <th>B_Addr1</th>
                                <th>B_Addr2</th>
                                <th>B_cDt</th>
                                <th>B_uDt</th>
                                <th>Modify</th>
                                <th>Delete</th>
							</tr>
						</thead>
						<tbody>
							<% for(let i=0; i<data.length; i++){ %>
							<tr>
                                <td><%=data[i].B_ID%></td>
                                <td><%=data[i].B_Name%></td>
                                <td><%=data[i].B_Tel%></td>
                                <td><%=data[i].B_Fax%></td>
                                <td><%=data[i].B_Email%></td>
                                <td><%=data[i].B_Zip%></td>
                                <td><%=data[i].B_Addr1%></td>
                                <td><%=data[i].B_Addr2%></td>
                                <td><%=data[i].B_cDt%></td>
                                <td><%=data[i].B_uDt%></td>
								<td><a class="dropdown-item" id="edit" id='<%=data[i].B_ID%>'><i class="icon-pencil6" onclick="edit(this)"></i> Edit</a></td>
                                <td><a href="#" class="dropdown-item" id='<%=data[i].B_ID%>' onclick="del(this)"><i class="icon-trash"></i> Delete</a></td>			
							</tr>
							<% } %>  
							
						</tbody>
	
					</table>
				</div>
				</div>
			</div>

		</section>
		<!-- /Page Container ends -->
		<!-- ScrolltoTop -->
		<!-- <a id="scrollTop" href="#top"><i class="icon-arrow-up12"></i></a> -->
		<!-- /ScrolltoTop -->
		<% include templates/admin_footer.ejs %>
	</div>

	<script>

var editor; // use a global for the submit and return data rendering in the examples
 $(document).ready(function() {
	 editor = new $.fn.dataTable.Editor({
		 ajax: "/admin/business",
		 table: "#tList",
		 fields: [{
				 label: "B_ID:",
				 name: "B_ID"
			 }, {
				 label: "B_Name:",
				 name: "B_Name"
			 }, {
				 label: "B_Tel:",
				 name: "B_Tel"
			 }, {
				 label: "B_Fax:",
				 name: "B_Fax"
			 }, {
				 label: "B_Email:",
				 name: "B_Email"
			 }, {
				 label: "B_Zip:",
				 name: "B_Zip"
			 }, {
				 label: "B_Addr1:",
				 name: "start_date"
			 }, {
				 label: "B_Addr2:",
				 name: "B_Addr2"
			 },{
				 label: "B_cDt:",
				 name: "B_cDt",
				 type: "datatime"
			 },{
				 label: "B_uDt:",
				 name: "B_uDt",
				 type: "datatime"
			 }
		 ]
	 } );
	 
	 $('#tList').on( 'click', 'tbody td:not(:first-child)', function (e) {
		 alert("dd")
		 editor.inline( this, {
			 submit: 'allIfChanged'
		 } );
	 } );
	});
  
// 	 $('#tList').DataTable( {
// 		 dom: "Bfrtip",
// 		 ajax: "../php/staff.php",
// 		 columns: [
// 			 {
// 				 data: null,
// 				 defaultContent: '',
// 				 className: 'select-checkbox',
// 				 orderable: false
// 			 },
// 			 { data: "first_name" },
// 			 { data: "last_name" },
// 			 { data: "position" },
// 			 { data: "office" },
// 			 { data: "start_date" },
// 			 { data: "salary", render: $.fn.dataTable.render.number( ',', '.', 0, '$' ) }
// 		 ],
// 		 order: [ 1, 'asc' ],
// 		 select: {
// 			 style:    'os',
// 			 selector: 'td:first-child'
// 		 },
// 		 buttons: [
// 			 { extend: "create", editor: editor },
// 			 { extend: "edit",   editor: editor },
// 			 { extend: "remove", editor: editor }
// 		 ]
// 	 } );
//  } );


	function del(e){
	  let bId = e.id;
	  //alert(bId)
      $.ajax({
        url: '/admin/businessDelete',
        method: 'post',
        dataType: 'json',
        data: {'bId' : bId},
        success: function(res){
            alert("삭제");
            location.reload()
        }
      })
  }
	</script>
</body>
</html>
